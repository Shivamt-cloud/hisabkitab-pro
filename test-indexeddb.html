<!DOCTYPE html>
<html>
<head>
    <title>IndexedDB Test</title>
</head>
<body>
    <h1>IndexedDB Data Checker</h1>
    <button onclick="checkData()">Check IndexedDB Data</button>
    <pre id="output"></pre>
    
    <script>
        async function checkData() {
            const output = document.getElementById('output');
            output.textContent = 'Checking...';
            
            try {
                const dbName = 'inventory_db';
                const dbVersion = 1;
                
                const request = indexedDB.open(dbName, dbVersion);
                
                request.onsuccess = (event) => {
                    const db = event.target.result;
                    const stores = db.objectStoreNames;
                    const result = { stores: Array.from(stores), data: {} };
                    
                    let storeCount = 0;
                    const totalStores = stores.length;
                    
                    if (totalStores === 0) {
                        output.textContent = 'No stores found in IndexedDB';
                        return;
                    }
                    
                    stores.forEach((storeName) => {
                        const transaction = db.transaction([storeName], 'readonly');
                        const store = transaction.objectStore(storeName);
                        const getAllRequest = store.getAll();
                        
                        getAllRequest.onsuccess = () => {
                            result.data[storeName] = getAllRequest.result.length + ' items';
                            storeCount++;
                            
                            if (storeCount === totalStores) {
                                output.textContent = JSON.stringify(result, null, 2);
                            }
                        };
                        
                        getAllRequest.onerror = () => {
                            result.data[storeName] = 'Error reading';
                            storeCount++;
                            if (storeCount === totalStores) {
                                output.textContent = JSON.stringify(result, null, 2);
                            }
                        };
                    });
                };
                
                request.onerror = () => {
                    output.textContent = 'Error opening database: ' + request.error;
                };
            } catch (error) {
                output.textContent = 'Error: ' + error.message;
            }
        }
    </script>
</body>
</html>
